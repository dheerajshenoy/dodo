---
app-id: io.github.dheerajshenoy.dodo

runtime: org.kde.Sdk
runtime-version: "6.9"
sdk: org.kde.Sdk

command: dodo

finish-args:
    - --filesystem=xdg-documents
    - --filesystem=xdg-download
    - --filesystem=~/.config/dodo
    - --filesystem=/run/media
    - --filesystem=/media
    - --share=ipc
    - --socket=wayland
    - --socket=fallback-x11
    - --device=shm
    - --device=dri

modules:
    - name: dodo
      buildsystem: simple
      build-commands:
          - ./flatpak_helper.sh
      post-install:
          - install -Dm644 resources/hicolor/256x256/apps/dodo.png /app/share/icons/hicolor/256x256/apps/io.github.dheerajshenoy.dodo.png
          - desktop-file-install --delete-original --dir=/app/share/applications flatpak/io.github.dheerajshenoy.dodo.desktop
          - install -Dm644 flatpak/io.github.dheerajshenoy.dodo.metainfo.xml /app/share/metainfo/io.github.dheerajshenoy.dodo.metainfo.xml
      sources:
          - type: git
            url: https://github.com/dheerajshenoy/dodo.git
            branch: main
          - type: file
            path: io.github.dheerajshenoy.dodo.metainfo.xml
          - type: file
            path: io.github.dheerajshenoy.dodo.desktop
          - type: file
            url: https://mupdf.com/downloads/archive/mupdf-1.27.0-source.tar.gz
            sha256: ae2442416de499182d37a526c6fa2bacc7a3bed5a888d113ca04844484dfe7c6
            dest: external
            dest-filename: mupdf-1.27.0-source.tar.gz
cleanup:
    - /share/man
    - /include
    - /lib/pkgconfig
    - /share/aclocal
    - /share/man
    - "*.la"
    - "*.a"
